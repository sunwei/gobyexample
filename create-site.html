<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>深入理解Hugo: Create Site</title>
    <link rel=stylesheet href="site.css">
  </head>
  <script>
      onkeydown = (e) => {
          
          if (e.key == "ArrowLeft") {
              window.location.href = 'collect-module';
          }
          
          
      }
  </script>
  <body>
    <div class="example" id="create-site">
      <h2><a href="./">深入理解Hugo</a>: Create Site</h2>
      
      <table>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            <a href="https://go.dev/play/p/vqCc3mPLLOs"><img title="Run code" src="play.png" class="run" /></a><img title="Copy code" src="clipboard.png" class="copy" />
          <pre class="chroma"><span class="kn">package</span> <span class="nx">main</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;fmt&#34;</span>
    <span class="s">&#34;strings&#34;</span>
<span class="p">)</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">type</span> <span class="nx">configProvider</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">DefaultLanguage</span> <span class="kt">string</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Language manages specific-language configuration.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">type</span> <span class="nx">Language</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">Lang</span> <span class="kt">string</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>If set per language, this tells Hugo that all content files without any
language indicator (e.g. my-page.en.md) is in this language.
This is usually a path relative to the working dir, but it can be an
absolute directory reference. It is what we get.
For internal use.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">ContentDir</span> <span class="kt">string</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Global config.
For internal use.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">Cfg</span> <span class="nx">configProvider</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Site contains all the information relevant for constructing a static
site.  The basic flow of information is as follows:</p>

<ol>
<li><p>A list of Files is parsed and then converted into Pages.</p>

<ol>
<li><p>Pages contain sections (based on the file they were generated from),
aliases and slugs (included in a pages frontmatter) which are the
various targets that will get generated.  There will be canonical
listing.  The canonical path can be overruled based on a pattern.</p></li>

<li><p>Taxonomies are created via configuration and will present some aspect of
the final page and typically a perm url.</p></li>

<li><p>All Pages are passed through a template based on their desired
layout based on numerous different elements.</p></li>
</ol></li>

<li><p>The entire collection of files is written to disk.</p></li>
</ol>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">type</span> <span class="nx">Site</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">language</span> <span class="o">*</span><span class="nx">Language</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Output formats defined in site config per Page Kind, or some defaults
if not set.
Output formats defined in Page front matter will override these.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">outputFormats</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Formats</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>All the output formats and media types available for this site.
These values will be merged from the Hugo defaults, the site config and,
finally, the language settings.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">outputFormatsConfig</span> <span class="nx">Formats</span>
    <span class="nx">mediaTypesConfig</span>    <span class="nx">Types</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">cusCfg</span> <span class="o">:=</span> <span class="nx">configProvider</span><span class="p">{</span>
        <span class="nx">DefaultLanguage</span><span class="p">:</span> <span class="s">&#34;en&#34;</span><span class="p">,</span>
    <span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="nx">lang</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Language</span><span class="p">{</span>
        <span class="nx">Lang</span><span class="p">:</span>       <span class="nx">cusCfg</span><span class="p">.</span><span class="nx">DefaultLanguage</span><span class="p">,</span>
        <span class="nx">ContentDir</span><span class="p">:</span> <span class="s">&#34;mycontent&#34;</span><span class="p">,</span>
        <span class="nx">Cfg</span><span class="p">:</span>        <span class="nx">cusCfg</span><span class="p">,</span>
    <span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="nx">mediaTypes</span> <span class="o">:=</span> <span class="nf">DecodeTypes</span><span class="p">()</span>
    <span class="nx">formats</span> <span class="o">:=</span> <span class="nf">DecodeFormats</span><span class="p">(</span><span class="nx">mediaTypes</span><span class="p">)</span>
    <span class="nx">outputFormats</span> <span class="o">:=</span> <span class="nf">createSiteOutputFormats</span><span class="p">(</span><span class="nx">formats</span><span class="p">)</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="nx">s</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="nx">Site</span><span class="p">{</span>
        <span class="nx">language</span><span class="p">:</span> <span class="nx">lang</span><span class="p">,</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">        <span class="nx">outputFormats</span><span class="p">:</span>       <span class="nx">outputFormats</span><span class="p">,</span>
        <span class="nx">outputFormatsConfig</span><span class="p">:</span> <span class="nx">formats</span><span class="p">,</span>
        <span class="nx">mediaTypesConfig</span><span class="p">:</span>    <span class="nx">mediaTypes</span><span class="p">,</span>
    <span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="s">&#34;Site:&#34;</span><span class="p">)</span>
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Printf</span><span class="p">(</span><span class="s">&#34;%#v\n&#34;</span><span class="p">,</span> <span class="nx">s</span><span class="p">)</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Type (also known as MIME type and content type) is a two-part identifier for
file formats and format contents transmitted on the Internet.
For Hugo&rsquo;s use case, we use the top-level type name / subtype name + suffix.
One example would be application/svg+xml
If suffix is not provided, the sub type will be used.
See // <a href="https://en.wikipedia.org/wiki/Media_type">https://en.wikipedia.org/wiki/Media_type</a></p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">type</span> <span class="nx">Type</span> <span class="kd">struct</span> <span class="p">{</span>
    <span class="nx">MainType</span>  <span class="kt">string</span> <span class="s">`json:&#34;mainType&#34;`</span>  <span class="c1">// i.e. text
</span><span class="c1"></span>    <span class="nx">SubType</span>   <span class="kt">string</span> <span class="s">`json:&#34;subType&#34;`</span>   <span class="c1">// i.e. html
</span><span class="c1"></span>    <span class="nx">Delimiter</span> <span class="kt">string</span> <span class="s">`json:&#34;delimiter&#34;`</span> <span class="c1">// e.g. &#34;.&#34;
</span><span class="c1"></span><span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Type returns a string representing the main- and sub-type of a media type, e.g. &ldquo;text/css&rdquo;.
A suffix identifier will be appended after a &ldquo;+&rdquo; if set, e.g. &ldquo;image/svg+xml&rdquo;.
Hugo will register a set of default media types.
These can be overridden by the user in the configuration,
by defining a media type with the same Type.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">func</span> <span class="p">(</span><span class="nx">m</span> <span class="nx">Type</span><span class="p">)</span> <span class="nf">Type</span><span class="p">()</span> <span class="kt">string</span> <span class="p">{</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Examples are
image/svg+xml
text/css</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="k">return</span> <span class="nx">m</span><span class="p">.</span><span class="nx">MainType</span> <span class="o">+</span> <span class="s">&#34;/&#34;</span> <span class="o">+</span> <span class="nx">m</span><span class="p">.</span><span class="nx">SubType</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Types is a slice of media types.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">type</span> <span class="nx">Types</span> <span class="p">[]</span><span class="nx">Type</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">const</span> <span class="nx">defaultDelimiter</span> <span class="p">=</span> <span class="s">&#34;.&#34;</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">var</span> <span class="nx">HTMLType</span> <span class="p">=</span> <span class="nf">newMediaType</span><span class="p">(</span><span class="s">&#34;text&#34;</span><span class="p">,</span> <span class="s">&#34;html&#34;</span><span class="p">)</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">func</span> <span class="nf">newMediaType</span><span class="p">(</span><span class="nx">main</span><span class="p">,</span> <span class="nx">sub</span> <span class="kt">string</span><span class="p">)</span> <span class="nx">Type</span> <span class="p">{</span>
    <span class="nx">t</span> <span class="o">:=</span> <span class="nx">Type</span><span class="p">{</span>
        <span class="nx">MainType</span><span class="p">:</span>  <span class="nx">main</span><span class="p">,</span>
        <span class="nx">SubType</span><span class="p">:</span>   <span class="nx">sub</span><span class="p">,</span>
        <span class="nx">Delimiter</span><span class="p">:</span> <span class="nx">defaultDelimiter</span><span class="p">}</span>
    <span class="k">return</span> <span class="nx">t</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>DefaultTypes is the default media types supported by Hugo.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">var</span> <span class="nx">DefaultTypes</span> <span class="p">=</span> <span class="nx">Types</span><span class="p">{</span>
    <span class="nx">HTMLType</span><span class="p">,</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>DecodeTypes takes a list of media type configurations and merges those,
in the order given, with the Hugo defaults as the last resort.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">func</span> <span class="nf">DecodeTypes</span><span class="p">()</span> <span class="nx">Types</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">m</span> <span class="nx">Types</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>remove duplications
Maps type string to Type. Type string is the full application/svg+xml.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">mmm</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Type</span><span class="p">)</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">dt</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">DefaultTypes</span> <span class="p">{</span>
        <span class="nx">mmm</span><span class="p">[</span><span class="nx">dt</span><span class="p">.</span><span class="nf">Type</span><span class="p">()]</span> <span class="p">=</span> <span class="nx">dt</span>
    <span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">v</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">mmm</span> <span class="p">{</span>
        <span class="nx">m</span> <span class="p">=</span> <span class="nb">append</span><span class="p">(</span><span class="nx">m</span><span class="p">,</span> <span class="nx">v</span><span class="p">)</span>
    <span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="k">return</span> <span class="nx">m</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Format represents an output representation, usually to a file on disk.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">type</span> <span class="nx">Format</span> <span class="kd">struct</span> <span class="p">{</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>The Name is used as an identifier. Internal output formats (i.e. HTML and RSS)
can be overridden by providing a new definition for those types.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">Name</span> <span class="kt">string</span> <span class="s">`json:&#34;name&#34;`</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="nx">MediaType</span> <span class="nx">Type</span> <span class="s">`json:&#34;-&#34;`</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>The base output file name used when not using &ldquo;ugly URLs&rdquo;, defaults to &ldquo;index&rdquo;.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">BaseName</span> <span class="kt">string</span> <span class="s">`json:&#34;baseName&#34;`</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Formats is a slice of Format.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">type</span> <span class="nx">Formats</span> <span class="p">[]</span><span class="nx">Format</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>GetByName gets a format by its identifier name.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">func</span> <span class="p">(</span><span class="nx">formats</span> <span class="nx">Formats</span><span class="p">)</span> <span class="nf">GetByName</span><span class="p">(</span>
    <span class="nx">name</span> <span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="nx">f</span> <span class="nx">Format</span><span class="p">,</span> <span class="nx">found</span> <span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="nx">_</span><span class="p">,</span> <span class="nx">ff</span> <span class="o">:=</span> <span class="k">range</span> <span class="nx">formats</span> <span class="p">{</span>
        <span class="k">if</span> <span class="nx">strings</span><span class="p">.</span><span class="nf">EqualFold</span><span class="p">(</span><span class="nx">name</span><span class="p">,</span> <span class="nx">ff</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">f</span> <span class="p">=</span> <span class="nx">ff</span>
            <span class="nx">found</span> <span class="p">=</span> <span class="kc">true</span>
            <span class="k">return</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">return</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>HTMLFormat An ordered list of built-in output formats.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">var</span> <span class="nx">HTMLFormat</span> <span class="p">=</span> <span class="nx">Format</span><span class="p">{</span>
    <span class="nx">Name</span><span class="p">:</span>      <span class="s">&#34;HTML&#34;</span><span class="p">,</span>
    <span class="nx">MediaType</span><span class="p">:</span> <span class="nx">HTMLType</span><span class="p">,</span>
    <span class="nx">BaseName</span><span class="p">:</span>  <span class="s">&#34;index&#34;</span><span class="p">,</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>DefaultFormats contains the default output formats supported by Hugo.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">var</span> <span class="nx">DefaultFormats</span> <span class="p">=</span> <span class="nx">Formats</span><span class="p">{</span>
    <span class="nx">HTMLFormat</span><span class="p">,</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>DecodeFormats takes a list of output format configurations and merges those,
in the order given, with the Hugo defaults as the last resort.</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="kd">func</span> <span class="nf">DecodeFormats</span><span class="p">(</span><span class="nx">mediaTypes</span> <span class="nx">Types</span><span class="p">)</span> <span class="nx">Formats</span> <span class="p">{</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Format could be modified by mediaTypes configuration
just make it simple for example</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
    <span class="nx">fmt</span><span class="p">.</span><span class="nf">Println</span><span class="p">(</span><span class="nx">mediaTypes</span><span class="p">)</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="nx">f</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="nx">Formats</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="nx">DefaultFormats</span><span class="p">))</span>
    <span class="nb">copy</span><span class="p">(</span><span class="nx">f</span><span class="p">,</span> <span class="nx">DefaultFormats</span><span class="p">)</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="k">return</span> <span class="nx">f</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">func</span> <span class="nf">createSiteOutputFormats</span><span class="p">(</span>
    <span class="nx">allFormats</span> <span class="nx">Formats</span><span class="p">)</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Formats</span> <span class="p">{</span>
    <span class="nx">defaultOutputFormats</span> <span class="o">:=</span>
        <span class="nf">createDefaultOutputFormats</span><span class="p">(</span><span class="nx">allFormats</span><span class="p">)</span>
    <span class="k">return</span> <span class="nx">defaultOutputFormats</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">const</span> <span class="p">(</span>
    <span class="nx">KindPage</span> <span class="p">=</span> <span class="s">&#34;page&#34;</span>
    <span class="nx">kind404</span>  <span class="p">=</span> <span class="s">&#34;404&#34;</span>
<span class="p">)</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma"><span class="kd">func</span> <span class="nf">createDefaultOutputFormats</span><span class="p">(</span>
    <span class="nx">allFormats</span> <span class="nx">Formats</span><span class="p">)</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Formats</span> <span class="p">{</span>
    <span class="nx">htmlOut</span><span class="p">,</span> <span class="nx">_</span> <span class="o">:=</span> <span class="nx">allFormats</span><span class="p">.</span><span class="nf">GetByName</span><span class="p">(</span><span class="nx">HTMLFormat</span><span class="p">.</span><span class="nx">Name</span><span class="p">)</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code leading">
            
          <pre class="chroma">    <span class="nx">m</span> <span class="o">:=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="nx">Formats</span><span class="p">{</span>
        <span class="nx">KindPage</span><span class="p">:</span> <span class="p">{</span><span class="nx">htmlOut</span><span class="p">},</span>
        <span class="nx">kind404</span><span class="p">:</span>  <span class="p">{</span><span class="nx">htmlOut</span><span class="p">},</span>
    <span class="p">}</span>
</pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code">
            
          <pre class="chroma">    <span class="k">return</span> <span class="nx">m</span>
<span class="p">}</span>
</pre>
          </td>
        </tr>
        
      </table>
      
      <table>
        
        <tr>
          <td class="docs">
            <p>解析Formats传入的MediaType</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="go">[{text html .}]</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            <p>Site实例
拥有了语言相关的配置项
每个页面类型也明确了自己的输出格式</p>

          </td>
          <td class="code leading">
            
          <pre class="chroma">
<span class="go">Site:
</span><span class="go">&amp;main.Site{
</span><span class="go">  language:(*main.Language)(0xc0000161b0),
</span><span class="go">  outputFormats:map[string]main.Formats{
</span><span class="go">    &#34;404&#34;:main.Formats{
</span><span class="go">      main.Format{
</span><span class="go">        Name:&#34;HTML&#34;,
</span><span class="go">        MediaType:main.Type{
</span><span class="go">          MainType:&#34;text&#34;,
</span><span class="go">          SubType:&#34;html&#34;,
</span><span class="go">          Delimiter:&#34;.&#34;}, BaseName:&#34;index&#34;}},
</span><span class="go">    &#34;page&#34;:main.Formats{
</span><span class="go">      main.Format{
</span><span class="go">        Name:&#34;HTML&#34;,
</span><span class="go">        MediaType:main.Type{
</span><span class="go">          MainType:&#34;text&#34;,
</span><span class="go">          SubType:&#34;html&#34;,
</span><span class="go">          Delimiter:&#34;.&#34;}, BaseName:&#34;index&#34;}}},
</span><span class="go">  outputFormatsConfig:main.Formats{
</span><span class="go">    main.Format{
</span><span class="go">      Name:&#34;HTML&#34;,
</span><span class="go">      MediaType:main.Type{
</span><span class="go">        MainType:&#34;text&#34;,
</span><span class="go">        SubType:&#34;html&#34;,
</span><span class="go">        Delimiter:&#34;.&#34;}, BaseName:&#34;index&#34;}},
</span><span class="go">  mediaTypesConfig:main.Types{
</span><span class="go">    main.Type{MainType:&#34;text&#34;,
</span><span class="go">    SubType:&#34;html&#34;, Delimiter:&#34;.&#34;}}}</span></pre>
          </td>
        </tr>
        
        <tr>
          <td class="docs">
            
          </td>
          <td class="code">
            
          <pre class="chroma"><span class="go">Program exited.</span></pre>
          </td>
        </tr>
        
      </table>
      
      

    <p class="footer">
      by <a href="https://sunwei.xyz">孙伟</a>
      | <a href="https://github.com/sunwei/gobyexample">source</a>
      | <a href="https://github.com/sunwei/gobyexample#license">license</a>
      | Inspired by <a href="https://github.com/mmcgrana/gobyexample">gobyexample.com</a>
      | Build with LOVE 💞
    </p>

    </div>
    <script>
      var codeLines = [];
      codeLines.push('package main\u000A');codeLines.push('import (\u000A    \"fmt\"\u000A    \"strings\"\u000A)\u000A');codeLines.push('type configProvider struct {\u000A    DefaultLanguage string\u000A}\u000A');codeLines.push('type Language struct {\u000A    Lang string\u000A');codeLines.push('    ContentDir string\u000A');codeLines.push('    Cfg configProvider\u000A}\u000A');codeLines.push('type Site struct {\u000A    language *Language\u000A');codeLines.push('    outputFormats map[string]Formats\u000A');codeLines.push('    outputFormatsConfig Formats\u000A    mediaTypesConfig    Types\u000A}\u000A');codeLines.push('func main() {\u000A    cusCfg :\u003D configProvider{\u000A        DefaultLanguage: \"en\",\u000A    }\u000A');codeLines.push('    lang :\u003D \u0026Language{\u000A        Lang:       cusCfg.DefaultLanguage,\u000A        ContentDir: \"mycontent\",\u000A        Cfg:        cusCfg,\u000A    }\u000A');codeLines.push('    mediaTypes :\u003D DecodeTypes()\u000A    formats :\u003D DecodeFormats(mediaTypes)\u000A    outputFormats :\u003D createSiteOutputFormats(formats)\u000A');codeLines.push('    s :\u003D \u0026Site{\u000A        language: lang,\u000A');codeLines.push('        outputFormats:       outputFormats,\u000A        outputFormatsConfig: formats,\u000A        mediaTypesConfig:    mediaTypes,\u000A    }\u000A');codeLines.push('    fmt.Println(\"Site:\")\u000A    fmt.Printf(\"%#v\\n\", s)\u000A}\u000A');codeLines.push('type Type struct {\u000A    MainType  string `json:\"mainType\"`  // i.e. text\u000A    SubType   string `json:\"subType\"`   // i.e. html\u000A    Delimiter string `json:\"delimiter\"` // e.g. \".\"\u000A}\u000A');codeLines.push('func (m Type) Type() string {\u000A');codeLines.push('    return m.MainType + \"/\" + m.SubType\u000A}\u000A');codeLines.push('type Types []Type\u000A');codeLines.push('const defaultDelimiter \u003D \".\"\u000A');codeLines.push('var HTMLType \u003D newMediaType(\"text\", \"html\")\u000A');codeLines.push('func newMediaType(main, sub string) Type {\u000A    t :\u003D Type{\u000A        MainType:  main,\u000A        SubType:   sub,\u000A        Delimiter: defaultDelimiter}\u000A    return t\u000A}\u000A');codeLines.push('var DefaultTypes \u003D Types{\u000A    HTMLType,\u000A}\u000A');codeLines.push('func DecodeTypes() Types {\u000A    var m Types\u000A');codeLines.push('    mmm :\u003D make(map[string]Type)\u000A    for _, dt :\u003D range DefaultTypes {\u000A        mmm[dt.Type()] \u003D dt\u000A    }\u000A');codeLines.push('    for _, v :\u003D range mmm {\u000A        m \u003D append(m, v)\u000A    }\u000A');codeLines.push('    return m\u000A}\u000A');codeLines.push('type Format struct {\u000A');codeLines.push('    Name string `json:\"name\"`\u000A');codeLines.push('    MediaType Type `json:\"-\"`\u000A');codeLines.push('    BaseName string `json:\"baseName\"`\u000A}\u000A');codeLines.push('type Formats []Format\u000A');codeLines.push('func (formats Formats) GetByName(\u000A    name string) (f Format, found bool) {\u000A    for _, ff :\u003D range formats {\u000A        if strings.EqualFold(name, ff.Name) {\u000A            f \u003D ff\u000A            found \u003D true\u000A            return\u000A        }\u000A    }\u000A    return\u000A}\u000A');codeLines.push('var HTMLFormat \u003D Format{\u000A    Name:      \"HTML\",\u000A    MediaType: HTMLType,\u000A    BaseName:  \"index\",\u000A}\u000A');codeLines.push('var DefaultFormats \u003D Formats{\u000A    HTMLFormat,\u000A}\u000A');codeLines.push('func DecodeFormats(mediaTypes Types) Formats {\u000A');codeLines.push('    fmt.Println(mediaTypes)\u000A');codeLines.push('    f :\u003D make(Formats, len(DefaultFormats))\u000A    copy(f, DefaultFormats)\u000A');codeLines.push('    return f\u000A}\u000A');codeLines.push('func createSiteOutputFormats(\u000A    allFormats Formats) map[string]Formats {\u000A    defaultOutputFormats :\u003D\u000A        createDefaultOutputFormats(allFormats)\u000A    return defaultOutputFormats\u000A}\u000A');codeLines.push('const (\u000A    KindPage \u003D \"page\"\u000A    kind404  \u003D \"404\"\u000A)\u000A');codeLines.push('func createDefaultOutputFormats(\u000A    allFormats Formats) map[string]Formats {\u000A    htmlOut, _ :\u003D allFormats.GetByName(HTMLFormat.Name)\u000A');codeLines.push('    m :\u003D map[string]Formats{\u000A        KindPage: {htmlOut},\u000A        kind404:  {htmlOut},\u000A    }\u000A');codeLines.push('    return m\u000A}\u000A');codeLines.push('');codeLines.push('');codeLines.push('');
    </script>
    <script src="site.js" async></script>
  </body>
</html>
